<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <record id="kami_sm_attendance_action" model="ir.actions.act_window">
    <field name="name">Atendimentos</field>
    <field name="res_model">kami_sm.attendance</field>
    <field name="view_mode">tree,form,kanban</field>
    <field name="context">{'search_default_available': True}</field>
  </record>

  <record id="kami_sm_attendance_view_tree" model="ir.ui.view">
    <field name="name">kami_sm.attendance.tree</field>
    <field name="model">kami_sm.attendance</field>
    <field name="arch" type="xml">
        <tree 
          string="Atendimentos"
          decoration-success="state == 'approved'"
          decoration-muted="state == 'done'"          
        >
          <field name="seller_id"/>
          <field name="client_id"/>
          <field name="attendance_type_id"/>
          <field name="attendance_theme_id"/>
          <field name="partner_id"/>
          <field name="expected_audience"/>
          <field name="activity_date"/>
          <field name="attendance_cost"/>
          <field name="extra_cost"/>
          <field name="total_cost"/>
          <field name="state" invisible="1" />
        </tree>
    </field>
  </record>

  <record id="kami_sm_attendance_view_form" model="ir.ui.view">
    <field name="name">kami_sm.attendance.form</field>
    <field name="model">kami_sm.attendance</field>
    <field name="arch" type="xml">
      <form string="Atendimento">
        <header>        
          <button 
            name="action_approve_attendance"
            string="Aprovar"
            type="object"
            class="oe_highlight"
            states="new"
          />
          <button
            name="action_request_cancel"
            string="Solicitar Cancelamento"
            type="object"
            class="oe_highlight"
            states="new,approved"
          />
          <button
            name="action_cancel_attendance"
            string="Cancelar"
            type="object"
            class="oe_highlight"
            states="new,approved"
          />
          <field 
            name="state"            
            widget="statusbar"
            statusbar_visible="new,approved,done,waiting,canceled"
          />
        </header>     
        <sheet>          
          <group>
            <field name="client_id"/>
            <field name="attendance_type_id"/> 
            <field name="attendance_theme_id"/> 
          </group>          
          <group>
            <field name="activity_date"/>
            <field name="partner_id"/>
            <field name="expected_audience"/>                             
          </group>
          <notebook>
            <page string="Detalhes">
              <group>
                <field name="description"/>                              
              </group>
            </page>
            <page string="Custos">
              <group>
                <field name="attendance_cost"/>
                <field name="extra_cost"/>
                <field name="total_cost"/>
              </group>
            </page>                         
          </notebook>           
        </sheet>
      </form>
    </field>
  </record>

  <record id="kami_sm_attendance_view_kanban" model="ir.ui.view">
    <field name="name">kami_sm.attendance.kanban</field>
    <field name="model">kami_sm.attendance</field>
    <field name="arch" type="xml">
      <kanban 
        default_group_by="state"
        records_draggable="false"
      >        
        <field name="state"/>
        <templates>
          <t t-name="kanban-box">
            <div class="oe_kanban_global_click">
              <field name="client_id"/>
              <br/>
              <field name="activity_date"/>
              <field name="partner_id"/>
            </div>
          </t>
        </templates>
      </kanban>
    </field>
  </record>

  <record id="view_kami_sm_attendance_search" model="ir.ui.view">
    <field name="name">kami_sm.attendance.search</field>
    <field name="model">kami_sm.attendance</field>
    <field name="arch" type="xml">
      <search string="Atendimento">
        <field name="seller_id"/>
        <field name="client_id"/>
        <field name="attendance_type_id"/>
        <field name="attendance_theme_id"/>
        <field name="partner_id"/>                        
        <separator/>
        <filter 
          string="Aguarando AprovaÃ§Ã£o"
          name="available"
          domain="[('state', '=', 'new')]"
        />
        <group expand="1" string="Group By">                 
          <filter 
            string="Tipo de Atendimento"
            name="attendance_type"
            context="{'group_by':'attendance_type_id'}"            
          />
          <filter 
            string="Tema do Atendimento"
            name="attendance_theme"
            context="{'group_by':'attendance_theme_id'}"            
          />
        </group>      
      </search>
    </field>
  </record>

</odoo>
  